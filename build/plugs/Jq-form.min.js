/*! singer version:0.1.0 2014-09-17 17:20:26 */
!function($,f,u){var valid={rules:{require:/[\w\W]+/,mobile:/^1[3458][0-9]{9}$/,email:/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,url:/^(\w+:\/\/)?\w+(\.\w+)+.*$/,number:/^\d+$/},rulesMsg:{require:"不能为空！",mobile:"请填写手机号码！",email:"请填写邮箱！",url:"请填写网址",number:"请填写数字"},getValue:function(a){var b,c=this;return a.is(":radio")?b=c.find(":radio[name='"+a.attr("name")+"']:checked").val():a.is(":checkbox")?(b="",c.find(":checkbox[name='"+a.attr("name")+"']:checked").each(function(){b+=$(this).val()+","})):b=a.val(),b=b===u?"":b,$.trim(b)},check:function(form){var $t=$(this),ps=$(form).data("valid"),opt=$t.data("valid")||$t.attr("data-valid");if(!opt)return!1;"string"==typeof opt&&(opt=eval("("+opt+")"));var rule=ps.rules[opt.type]||new RegExp(opt.type,"gi"),value=valid.getValue.call(form,$t),$tip=opt.tip?$(opt.tip):$t.siblings(".m-form-tip");if($tip&&1==$tip.length||($t.parent().append("<span class='m-form-tip'></span>"),$tip=$t.siblings(".m-form-tip")),!rule.test(value)){var msg=opt.msg||ps.rulesMsg[opt.type]||"输入错误！";return $t.addClass("control-error"),$tip.removeClass("valid-success").addClass("valid-error").html(msg),$(form).data("focus")||($t.focus(),$(top.window||window).scrollTop(0),$(form).data("focus",!f)),!1}return $t.removeClass("control-error"),$tip.removeClass("valid-error").addClass("valid-success").html(""),!0}},validForm=function(forms,options){var opts=$.extend({rules:valid.rules,rulesMsg:valid.rulesMsg},options||{}),$forms=this.forms=$(forms);return $.each(this.forms,function(i){var $item=$forms.eq(i),optionData=$item.data("form")||$item.attr("data-form"),ps=$.extend({},opts);optionData&&"string"==typeof optionData&&(optionData=eval("("+optionData+")")),optionData&&"object"==typeof optionData&&(ps=$.extend(ps,optionData)),$item.data("valid",ps),$item.delegate("[data-valid]","blur",function(){valid.check.call(this,$item)}).delegate(":text","press",function(a){13===a.keyCode&&ps.submitFn&&"function"==typeof ps.submitFn&&ps.submitFn()})}),this};validForm.prototype={check:function(){var a=!f,b=this.forms;return b.each(function(c){var d=b.eq(c);d.data("focus",f),d.find("[data-valid]").each(function(){valid.check.call(this,d)||(a=f)})}),a},json:function(a){var b=this.forms.eq(a||0),c={};return $.each(b.find("[name]"),function(){c.hasOwnProperty(this.name)||(c[this.name]=valid.getValue.call(b,$(this)))}),c},serialize:function(a){var b=this.json(a),c=[];for(var d in b)c.push(d+"="+encodeURI(b[d]));return c.join("&")}},$.fn.extend({serializeForm:function(a){var b=$(this),c={};return"form"!==b.get(0).tagName.toLowerCase()&&(b=$("<form>").append(b.clone(!0))),a&&"string"===a?b.serialize():a&&"array"===a?b.serializeArray():($(b.serializeArray()).each(function(){c.hasOwnProperty(this.name)?c[this.name]+=","+this.value:c[this.name]=this.value}),c)},valid:function(a){return new validForm(this,a)}})}(jQuery,!1,void 0);